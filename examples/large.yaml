APIVersion: "v1"
Strategy:
#Build
  - Cluster:
      Name: "gke_SomeCompany-preview_us-central1-a_build"
      Deployments:
        - Deployment:
           Name: "jenkins"
           Namespace: "jenkins"
           Git: "https://github.com/AlexsJones/devops-kubernetes-jenkins.git"
           Action:
            - Execute:
               Shell: ""
               Kubectl:
                 Command: replace
                 Path: Deployment
#Preview
  - Cluster:
      Name: "gke_SomeCompany-preview_us-central1-a_SomeCompany-preview-cluster"
      Deployments:
        - Deployment:
           Name: "SomeCompany-preview"
           Namespace: "preview"
           Git: "https://github.com/AlexsJones/devops-kubernetes-SomeCompany.git"
           Action:
            - Execute:
               Shell: "./build_environment.sh preview"
               Kubectl:
                 Command: replace
                 Path: Deployment
        - Deployment:
           Name: "tika"
           Namespace: "tika"
           Git: "https://github.com/AlexsJones/devops-kubernetes-tika.git"
           Action:
            - Execute:
               Shell: "./build_environment.sh default"
               Kubectl:
                 Command: replace
                 Path: Deployment
#Preview services
  - Cluster:
      Name: "gke_SomeCompany-preview_us-central1-a_SomeCompany-services"
      Deployments:
        - Deployment:
           Name: "queue"
           Namespace: "queue"
           Git: "https://github.com/AlexsJones/devops-kubernetes-queue.git"
           Action:
            - Execute:
               Shell: "./build_environment.sh preview"
               Kubectl:
                 Command: replace
                 Path: Deployment
        - Deployment:
           Name: "cron"
           Namespace: "service-cron"
           Git: "https://github.com/AlexsJones/devops-kubernetes-scheduler.git"
           Action:
            - Execute:
               Shell: "./build_environment.sh preview"
               Kubectl:
                 Command: replace
                 Path: Deployment
        - Deployment:
           Name: "devops"
           Namespace: "devops"
           Git: "https://github.com/SomeCompany/devops-kubernetes-go-cron"
           Action:
            - Execute:
               Shell: "./build_environment.sh preview"
               Kubectl:
                 Command: replace
                 Path: Deployment
        - Deployment:
           Name: "rabbitmq"
           Namespace: "rabbitmq"
           Git: "https://github.com/SomeCompany/devops-kubernetes-rabbitmq"
           Action:
            - Execute:
               Shell: "./build_environment.sh preview"
               Kubectl:
                 Command: replace
                 Path: Deployment
# Pre-production
  - Cluster:
      Name: "gke_SomeCompany-pre-production_us-central1-a_SomeCompany-preproduction"
      Deployments:
        - Deployment:
           Name: "SomeCompany-pre-production"
           Namespace: "pre-production"
           Git: "https://github.com/AlexsJones/devops-kubernetes-SomeCompany.git"
           Action:
            - Execute:
               Shell: "./build_environment.sh pre-production"
               Kubectl:
                 Command: replace
                 Path: Deployment
        - Deployment:
           Name: "tika"
           Namespace: "tika"
           Git: "https://github.com/AlexsJones/devops-kubernetes-tika.git"
           Action:
            - Execute:
               Shell: "./build_environment.sh default"
               Kubectl:
                 Command: replace
                 Path: Deployment
# Pre-production services
  - Cluster:
      Name: "gke_SomeCompany-pre-production_us-central1-a_SomeCompany-services"
      Deployments:
        - Deployment:
           Name: "queue"
           Namespace: "queue"
           Git: "https://github.com/AlexsJones/devops-kubernetes-queue.git"
           Action:
            - Execute:
               Shell: "./build_environment.sh pre-production"
               Kubectl:
                 Command: replace
                 Path: Deployment
        - Deployment:
           Name: "cron"
           Namespace: "service-cron"
           Git: "https://github.com/AlexsJones/devops-kubernetes-scheduler.git"
           Action:
            - Execute:
               Shell: "./build_environment.sh pre-production"
               Kubectl:
                 Command: replace
                 Path: Deployment
        - Deployment:
           Name: "devops"
           Namespace: "devops"
           Git: "https://github.com/SomeCompany/devops-kubernetes-go-cron"
           Action:
            - Execute:
               Shell: "./build_environment.sh pre-production"
               Kubectl:
                 Command: replace
                 Path: Deployment
        - Deployment:
           Name: "rabbitmq"
           Namespace: "rabbitmq"
           Git: "https://github.com/SomeCompany/devops-kubernetes-rabbitmq"
           Action:
            - Execute:
               Shell: "./build_environment.sh pre-production"
               Kubectl:
                 Command: replace
                 Path: Deployment
#Production
  - Cluster:
      Name: "gke_SomeCompany-production_us-east4-a_SomeCompany-production"
      Deployments:
        - Deployment:
           Name: "SomeCompany-production"
           Namespace: "production"
           Git: "https://github.com/AlexsJones/devops-kubernetes-SomeCompany.git"
           Action:
            - Execute:
               Shell: "./build_environment.sh production"
               Kubectl:
                 Command: replace
                 Path: Deployment
        - Deployment:
           Name: "tika"
           Namespace: "tika"
           Git: "https://github.com/AlexsJones/devops-kubernetes-tika.git"
           Action:
            - Execute:
               Shell: "./build_environment.sh default"
               Kubectl:
                 Command: replace
                 Path: Deployment
#Production services
  - Cluster:
      Name: "gke_SomeCompany-production_us-east4-a_SomeCompany-service-cluster"
      Deployments:
        - Deployment:
           Name: "queue"
           Namespace: "queue"
           Git: "https://github.com/AlexsJones/devops-kubernetes-queue.git"
           Action:
            - Execute:
               Shell: "./build_environment.sh production"
               Kubectl:
                 Command: replace
                 Path: Deployment
        - Deployment:
           Name: "cron"
           Namespace: "service-cron"
           Git: "https://github.com/AlexsJones/devops-kubernetes-scheduler.git"
           Action:
            - Execute:
               Shell: "./build_environment.sh production"
               Kubectl:
                 Command: replace
                 Path: Deployment
        - Deployment:
           Name: "devops"
           Namespace: "devops"
           Git: "https://github.com/SomeCompany/devops-kubernetes-go-cron"
           Action:
            - Execute:
               Shell: "./build_environment.sh production"
               Kubectl:
                 Command: replace
                 Path: Deployment
        - Deployment:
           Name: "rabbitmq"
           Namespace: "rabbitmq"
           Git: "https://github.com/SomeCompany/devops-kubernetes-rabbitmq"
           Action:
            - Execute:
               Shell: "./build_environment.sh production"
               Kubectl:
                 Command: replace
                 Path: Deployment
